---
title: LPIC201/202 あずき本 ch1 キャパシティプランニング
tags:
- LPIC201
- 勉強メモ
- 資格勉強
date: 2020-11-30T23:13:00+09:00
bibliography: https://www.shoeisha.co.jp/book/detail/9784798151250
---

# Do I Know This Already? #

## 1 キャパシティプランニングを行う際に測定すべきもの/測定する意味のないもの ##

- 測定すべきもの
  - swap使用率
  - メモリの使用率
  - ネットワークのトラフィック
  - CPUの使用率
- 測定する意味のないもの
  - swap領域サイズ

swap領域は勝手に増えたりしないので


## 2 スワップ領域の使用量計測に使えるもの ##

- vmstat
- cat /proc/swaps
- free


## 3 vmstatコマンドの出力の読み方 ##

- vmstatではネットワーク利用状況は把握できない
- us, sy, id, wa でCPU使用状況を把握する
- 例: idが0、usが0、syが10くらい、waが90くらい
  - CPUアイドル時間(id)が0になっている
  - 要因はユーザーアプリケーション(us)やシステム(sy)ではなくI/O待ち(wa)による
- free,buff,cacheでメモリ使用状況を把握する
- swpd,si,so,bi,boでスワップ使用状況を把握する
- 例: swpdが大きく、si,so,bi,boが0でない
  - スワップ領域が使用されており、スワップイン(si)・スワップアウト(so)、ディスクI/O(bi,bo)が常に発生している


## 4 sarの出力ファイル名、記録閲覧 ##

```sh
$ sar -b -f /var/log/sa/saXX
```

XXは2桁の日付


## 5 vmstatコマンドのオプション・表示内容 ##

```
Usage:
 vmstat [options] [delay [count]]
```

```sh
$ vmstat 1 3
```

```
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 1  0      0 23443260 351512 917396    0    0     3    14   50  120  1  0 99  0  0
 0  0      0 23443252 351512 917412    0    0     0     0   85  231  0  0 100  0  0
 0  0      0 23443252 351512 917412    0    0     0     0   71  201  0  0 100  0  0
```

- 1秒間隔で3回
- スワップ領域、バッファキャッシュ、ページキャッシュ等の**利用状況**を確認できる
- 搭載しているメモリ**総容量は確認できない**
  - `/proc/meminfo`で確認できる


```sh
cat /proc/meminfo 
```

```
MemTotal:       26212040 kB
...
```



## 6 プロセスごとのメモリ使用量を把握し、CPU消費の大きいものを特定するには ##

- `top`
- `ps aux` とかでも


## 7 sarの出力する統計情報をTSVで出力するには ##

- sadc: システム状況を収集し、ログに書き込む人
- sar: 収集データを表示する人
- sadf: ログをTSV, XML, JSON等で出力




# 1.1 キャパシティプランニング #

## 1.1.1 キャパシティプランニングとは ##



# 1.2 リソース使用率の測定とトラブルシューティング #

## 1.2.1 総合的なリソース使用率の測定 ##


## 1.2.2 CPU使用率の測定 ##


## 1.2.3 メモリおよびスワップ使用量の測定 ##


## 1.2.4 ディスク使用量の測定 ##



## 1.2.5 ネットワークトラフィックの測定 ##



# 1.3 リソース受容の分析と予測 #

## 1.3.1 リソース監視ツール ##

## 1.3.2 受容の分析と将来の予測 ##

## 1.3.3 リソースの問題解決 ##


